# ç¬¬äºŒå‘¨å‘¨æŠ¥

## æœ¬å‘¨å­¦ä¹ å†…å®¹

* pythonç±»çš„ä½¿ç”¨ï¼ˆ~~å¥½â™‚~~ğŸ¥µï¼‰
* pyechartsçš„ä½¿ç”¨

## ä¸‹å‘¨å­¦ä¹ å†…å®¹

* pythonç¨‹åºå¼€å‘
* å¤ä¹ å‰é¢æ‰€å­¦çš„çŸ¥è¯†(~~è¦è¢«pythonå¡«æ»¡äº†:heart:~~)

## å­¦ä¹ æˆæœæ¼”ç¤º

data_define.py

```python
class Record:

    def __init__(self, data, order_id, money, province):
        self.data = data             # è®¢å•æ—¥æœŸ
        self.order_id = order_id     # è®¢å•ç¼–å·
        self.money = money           # è®¢å•é‡‘é¢
        self.province = province     # è®¢å•çœä»½

    def __str__(self):
        return f"{self.data}, {self.order_id}, {self.money}, {self.province}"
```

file_define.py

```python
from data_define import Record
import json


class FileReader:

    def read_data(self) -> list[Record]:
        pass


class TextFileReader(FileReader):

    def __init__(self, path):
        self.path = path                              # å®šä¹‰æˆå‘˜å˜é‡è®°å½•æ–‡ä»¶çš„è·¯å¾„

    def read_data(self) -> list[Record]:
        f = open(self.path, "r", encoding="UTF-8")
        record_list: list[Record] = []
        for line in f.readlines():
            line = line.strip()                       # æ¶ˆé™¤æœ«å°¾çš„\n
            data_list = line.split(",")               # ä»¥â€œ,â€ä¸ºåˆ†å‰²ç‚¹æŠŠè¡Œä¸­å…ƒç´ å­˜å…¥åˆ—è¡¨
            record = Record(data_list[0], data_list[1], int(data_list[2]), data_list[3])
            record_list.append(record)

        f.close()
        return record_list


class JsonFileReader(FileReader):

    def __init__(self, path):
        self.path = path                              # å®šä¹‰æˆå‘˜å˜é‡è®°å½•æ–‡ä»¶çš„è·¯å¾„

    def read_data(self) -> list[Record]:
        f = open(self.path, "r", encoding="UTF-8")
        record_list: list[Record] = []
        for line in f.readlines():
            data_dict = json.loads(line)
            record = Record(data_dict["data"], data_dict["order_id"], int(data_dict["money"]), data_dict["province"])
            record_list.append(record)

        f.close()
        return record_list


if __name__ == '__main__':                            # è°ƒè¯•
    text_file_reader = TextFileReader("æ–‡ä»¶è·¯å¾„")
    json_file_reader = JsonFileReader("æ–‡ä»¶è·¯å¾„")
    list1 = text_file_reader.read_data()
    list2 = json_file_reader.read_data()

    for comment in list1:
        print(comment)

    for comment in list2:
        print(comment)

```

main.py

```python
from file_define import FileReader, TextFileReader, JsonFileReader
from data_define import Record
from pyecharts.charts import Bar
from pyecharts.options import *
from pyecharts.globals import ThemeType


text_file_reader = TextFileReader("æ–‡ä»¶è·¯å¾„")
json_file_reader = JsonFileReader("æ–‡ä»¶è·¯å¾„")

jan_data: list[Record] = text_file_reader.read_data()
feb_data: list[Record] = json_file_reader.read_data()
all_data: list[Record] = jan_data + feb_data     # åˆå¹¶æ•°æ®

# ç”¨å­—å…¸å­˜å‚¨æ•°æ®
data_dict = {}
for record in all_data:
    if record.data in data_dict.keys():
        data_dict[record.data] += record.money   # è‹¥æ— æ•°æ®åˆ™å–ä»£
    else:
        data_dict[record.data] = record.money  # è‹¥æœ‰æ•°æ®åˆ™ç›¸åŠ 

# å¯è§†åŒ–å›¾æ ‡å¼€å‘
bar = Bar(init_opts=InitOpts(theme=ThemeType.LIGHT))

bar.add_xaxis(list(data_dict.keys()))    # æ·»åŠ Xè½´æ•°æ®
bar.add_yaxis("é”€å”®é¢", list(data_dict.values()), label_opts=LabelOpts(is_show=False))    # æ·»åŠ Yè½´æ•°æ®
bar.set_global_opts(
    title_opts=TitleOpts(title="æ¯æ—¥é”€å”®é¢")
)

bar.render("æ¯æ—¥é”€å”®é¢æŸ±çŠ¶å›¾.html")

```

